---
# Overrides
#
# This file contains overrides for jobs that are inherited from external
# sources (shared CICD templates). This ensures external jobs follow
# the same pipeline workflow rules as defined at the root level.
#

# Standard configuration for external jobs to follow workflow rules
.external_job_config: &external_job_config
  needs: []
  rules:
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
    - if: $CI_COMMIT_BRANCH && $CI_OPEN_MERGE_REQUESTS
      when: never
    - if: $CI_COMMIT_BRANCH || $CI_COMMIT_TAG

# Override external security scanning jobs from shared templates
gl-secret-detection:
  <<: *external_job_config

gl-semgrep-sast:
  <<: *external_job_config

bandit-sast-scan:
  <<: *external_job_config

checkov-sast:
  <<: *external_job_config

grype-sca:
  <<: *external_job_config

semgrep-sast-scan:
  <<: *external_job_config

fortify-sast:
  <<: *external_job_config
  tags: [size:xlarge, arch:amd64]
