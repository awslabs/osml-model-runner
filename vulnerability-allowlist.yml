---
# General Allow List for GitLab Container Scanning
#
# This file contains explanations for any findings that are either false
# positives or do not apply to the model-runner codebase.
#
#
#

generalallowlist:
  # For kernel headers, please review https://docs.docker.com/engine/security/#linux-kernel-capabilities
  CVE-2023-6817: | # High: Use-after-free in netfilter subsystem in Linux kernel.
    This vulnerability is associated with a use-after-free flaw in the netfilter subsystem of the Linux kernel. 
    In our AWS containerized environment, direct interaction with the netfilter subsystem is not a typical operation.
    Netfilter requires CAP_NET_ADMIN capabilities for configuration, which our containers do not possess. 
  CVE-2024-0193: | # High: Use-after-free in netfilter subsystem in Linux kernel.
    This vulnerability is associated with a use-after-free flaw in the netfilter subsystem of the Linux kernel. 
    In our AWS containerized environment, direct interaction with the netfilter subsystem is not a typical operation.
    Netfilter requires CAP_NET_ADMIN capabilities for configuration, which our containers do not possess. 
  CVE-2023-2156: | # High: RPL protocol handling leading to denial of service conditon.
    Kernel Header - Only works on IPv6. We are not using IPv5 and network management is handled by infrastructure
    around the container.
  CVE-2023-2163: | # High: BPF flaw in Linux kernel.
    We do not use or interact with BPF in our controlled AWS containerized environment. BPF requires certain kernel privileges
    for operations like attaching to sockets or manipulating packet data. This means that the container must be run with
    --privilleged or NET_ADMIN to interact with BPF. We do not run our containers in NET_ADMIN or --privilleged mode.
    To expose the Linux kernel's networking subsystem to Docker, you must run docker with the -net=host flag. We do not run containers with 
    the -net=host flag.
    This is a kernel level vulnerability. Our controlled AWS containerized environment does not directly expose or interact with this
    kernel component, significantly reducing the risk of this vulnerability.
  CVE-2023-2236: |  # High: use-after-free io_install_fixed_file leading to local privilege escaltion.
    Kernel Header - Hardware management is handled by the infrastructure around the container.
  CVE-2023-31436: | # High: QoS can rigger an incorrect MTU value leading to privilege escalation.
    Kernel Header - Network management is handled by the infrastructure around the container. 
  CVE-2023-3609: | # High: Network Scheduler could allow an attacker to local privilege escalation
    Kernel Header - Network management is handled by the infrastructure around the container. 
  CVE-2023-3812: | # High: Linux TUN/TAP device driver escalate privileges
    Kernel Header - Hardware management is handled by infrastructure outside the container.
  CVE-2023-39191: | # High: User-supplied eBPF programs may allow an attacker with CAP_BPF privileges to escalate privileges
    Kernel Header - These containers do not contain user-supplied eBPF programs, and 
    Docker does not allow CAP_BPF capabilities (https://github.com/moby/moby/blob/master/oci/caps/defaults.go#L6-L19)
  CVE-2023-4128: | # High: Use-after-free on net/sched/cls_fw.c leading to local privilege escalation.
    Kernel Header -  Network management is handled by the infrastructure around the container.
  CVE-2023-4622: | # High: af_unix component flaw in Linux kernel.
    Our controlled AWS containerized environment does not interact with Linux/Unix domain sockets, and so cannot be exposed to this vulnerability.
    To create a af_unix socket in a container that's accessible to other processes, you must explictly create one in the docker run
    command. We do not do so.
    This is a kernel level vulnerability. Our controlled AWS containerized environment does not directly expose or interact with this
    kernel component, significantly reducing the risk of this vulnerability.
  CVE-2023-4623: | # High:  HFSC qdisc traffic control issue in Linux kernel.
    This vulnerability, a use-after-free issue in the HFSC qdisc traffic control of the Linux kernel, does not impact
    our AWS containerized environment. Qdisc is a traffic control utility in Linux that schedules traffic transmission
    by a network interface. Docker containers can only modify the network configuration of the host machine if explictly given NET_ADMIN
    privilleges, which we do not grant. To expose the Linux kernel's networking subsystem to Docker, you must run docker with the -net=host flag. 
    We do not run containers with the -net=host flag. This is a kernel level vulnerability. Our controlled AWS containerized environment does not 
    directly expose or interact with this kernel component, significantly reducing the risk of this vulnerability.
  CVE-2023-5178: | # High: Use after free vulnerability in nvme target drivers.
    Kernel Header - We are not using NVMe to TCP protocols to controllers. Hardware management is also
    handled outside of a container.
  CVE-2023-5345: | # High: Flaw in  SMB client component in Linux kernel.
    Kernel Header - Network management is handled by the infrastructure around the container, 
    SMB Client isn't utilized in container to begin with and won't affect the system.
  CVE-2023-5633:  |  # High: Use-after-free flaw with VMWare
    This flaw is only exposed when running inside a VMWare guest with 3D
    acceleration enabled which could allow an escalation of privileges. 
    This container is not running inside VMWare and is not using 3D
    acceleration.
  CVE-2023-42753: | # High: User with CAP_NET_ADMIN capability can escalate privileges
    CAP_NET_ADMIN capability is not activated in this container so exploit cannot occur.
  CVE-2023-45871: | # High: Overflow issue in IGB driver in Linux kernel.
    Our controlled AWS containerized environment do not interact directly with the IGB driver or the affected functionalities.
    Docker containers must be ran in privilleged / NET_ADMIN mode and the -net=host flags to connect the container to the host's network.
    Otherwise they cannot interact with IGBs via a driver. We do not run our containers in privilleged mode.
    This is a kernel level vulnerability. Our controlled AWS containerized environment does not directly expose or interact with this
    kernel component, significantly reducing the risk of this vulnerability.
  CVE-2023-6546: | # High: Race condition in GSM 0710 tty multiplexor in Linux kernel.
    The identified vulnerability in the GSM 0710 tty multiplexor of the Linux kernel involves a race condition that leads to a 
    use-after-free issue. This part of the kernel is not directly accessible or utilized within our controlled container 
    environment. Our containers operate with restricted privileges and do not have the necessary capabilities (like CAP_NET_ADMIN) 
    to interact at this level of the kernel's network stack. Therefore, the likelihood of this vulnerability being exploited in 
    our AWS containerized setup is extremely low. The infrastructure's encapsulation and isolation further ensure that such 
    kernel-level vulnerabilities are effectively shielded from impacting our containerized applications.



